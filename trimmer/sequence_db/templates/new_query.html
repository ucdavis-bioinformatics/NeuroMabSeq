{% extends 'base.html' %}
{% load widget_tweaks %}
{% load static %}

{% block content %}

<style>
table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
}

tr:nth-child(even) {
    background-color: #dddddd;
}
td {
    white-space: nowrap;
    align: left;
}

td.wrapok {
    white-space:normal
}

.sorting, .sorting_asc, .sorting_desc {
    background : none;
}
</style>

<!-- Datatables stuff -->
<!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">-->
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>-->


<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.17/css/jquery.dataTables.css">-->
<!--<script src="https://code.jquery.com/jquery-1.9.1.js"></script>-->
<!--<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.17/js/jquery.dataTables.js"></script>-->
<!--<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>-->
<!--<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/responsive/1.0.7/js/dataTables.responsive.min.js"></script>-->
<!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">-->

<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.9/css/jquery.dataTables.min.css">-->
<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/1.0.7/css/responsive.dataTables.min.css">-->

<link rel="stylesheet" href="{% static "css/bootstrap.min.css.1" %}">
<link rel="stylesheet" href="{% static "css/jquery.dataTables.css" %}">
<link rel="stylesheet" href="{% static "css/jquery.dataTables.min.css" %}">
<link rel="stylesheet" href="{% static "css/responsive.dataTables.min.css" %}">
<script src="{% static "js/jquery-1.9.1.js" %}"></script>
<script src="{% static "js/jquery.dataTables.js" %}"></script>
<script src="{% static "js/jquery.dataTables.min.js" %}"></script>
<script src="{% static "js/dataTables.responsive.min.js" %}"></script>
<script src="{% static "js/jquery.dataTables.js" %}"></script>



<script>

    var url_string = window.location.href
    var url = new URL(url_string);
    var mabid = url.searchParams.get("name_choice");
    var cat = url.searchParams.get("category_choice");
    var target = url.searchParams.get("target_choice");
    var clonality = url.searchParams.get("clonality");
    var ordering = url.searchParams.get("ordering");
    var search = url.searchParams.get("search");

    if (mabid==null){
        var mabid = ''
    }

    if (cat==null){
        var cat = ''
    }

    if (target==null){
        var target = ''
    }

    if (clonality==null){
        var clonality = 'Monoclonal'
    }

    if (ordering==null){
        var ordering = 'category'
    }

    if (search==null){
        var search = ''
    }


      $(document).ready(function() {
          $('#albums').DataTable({
              "searching": true,
              "sortable": true,
              "scrollX": true,
              'serverSide': true,
              'ajax': '/api/entry_list/?format=datatables' + '&mabid=' + mabid + '&category=' + cat + '&protein_target=' + target + '&clonality=' + clonality + '&ordering=' + ordering + '&search=' + search,
              'columns': [
                  {'data': 'mabid', 'sortable': true},
                  {'data': 'get_category', 'sortable': false},
                  {'data': 'clonality', 'sortable': false},
                  {'data': 'get_protein_target', 'sortable': false},
                  {'data': 'light_count', 'sortable': false},
                  {'data': 'heavy_count', 'sortable': false},
                  {'data': 'max_lcstars', 'sortable': false},
                  {'data': 'max_hcstars', 'sortable': false},
                  {'data': 'maxavgstars', 'sortable': false},
                  <!--Display as an checkmark emoji if true else nothing and make the pixels bigger-->
                  {'data': 'contains_verified', 'sortable': false, 
                  render: function ( data, type, row ) {
                        if (data == true){
                            return '&#9989;'
                        }
                        else{
                            return ''
                        }
                   }
                  },
                  {'data': 'get_url', 'sortable': false, render: function ( data, type, row ) {
                        return '<a class="btn btn-info btn-sm" href=/' + data + '>' + 'Show Full Entry' + '</a>';
                   }},
              ]

          });
      });
</script>



  <div class="w3-container w3-content w3-center w3-padding-32" style="max-width:10000px">
    <div class="well" style="background-color:EAEAEA;padding:10;border-radius:8px;">
      <form method="get">

      <h3 style="margin-top: 0">Entry Filter</h3>
      <div class="row"  >
          <div class="form-group col-sm-4 col-sm-3">
            <strong>Search mAb ID OR Protein Target:</strong>
          {% render_field filter.form.search class="form-control" %}
        </div>
        <div class="form-group col-sm-5 col-sm-3">
            <strong>mAb ID choice:</strong>
          {% render_field filter.form.name_choice class="form-control" %}
        </div>
        <div class="form-group col-sm-5 col-sm-3">
            <strong>Target choice:</strong>
          {% render_field filter.form.target_choice class="form-control" %}
        </div>
        <div class="form-group col-sm-5 col-sm-3">
            <strong>Category choice:
            </strong>
            For info on categories click<a href="/faq"> HERE</a>
          {% render_field filter.form.category_choice class="form-control" %}
        </div>

        <div class="form-group col-sm-5 col-sm-3">
            <strong>Clonality choice:
            </strong>
            For info on categories click<a href="/faq"> HERE</a>
          {% render_field filter.form.clonality class="form-control" %}
        </div>
        <div class="form-group col-sm-5 col-sm-3">
            <strong>Choose Display Order:</strong>
          {% render_field filter.form.ordering class="form-control" %}
        </div>
<!--          <div class="form-group col-sm-4 col-md-3">-->
<!--            <strong>Search mAb ID:</strong>-->
<!--          {% render_field filter.form.search_mabid class="form-control" %}-->
<!--        </div>-->

      </div>

        <button type="submit" class="btn btn-primary">
          <!-- Spyglass emoji -->
          &#128269; Search
        </button>


      </form>
         <div>
         <div align="center" style="padding:5px"
          <a href="/new_query">
           <!-- Refresh emoji -->
               <button  label="Sequence Database" name="so_link"  class="btn btn-warning">Reset Filter</button>
          </a>
         </div>
         <div align="right">
          <a href="/faq_list">
            <!-- Question emoji -->


               <button label="FAQ" name="so_link"  class="btn btn-info"> &#10067; Frequently Asked Questions</button>
          </a>
         </div>
       </div>
      </div>

</div>


  <div class="w3-container w3-content w3-center w3-padding-5" style="max-width:10000px">



  <h2>Entry Results</h2>
        <table align="left" id="albums" class="table table-striped table-bordered" style="width:100%" data-server-side="true">
          <thead>
            <tr align="left">
              <th align="left" >mAb ID</th>
              <th align="left" >Category</th>
              <th align="left" >Clonality</th>
              <th align="left" >Protein Target</th>
              <th align="left" ># Light Chain Sequences</th>
              <th align="left" ># Heavy Chain Sequences</th>
              <th align="left" >&star; Max LC Stars</th>
              <th align="left" >&star; Max HC Stars</th>
              <th align="left" >&star; Max Avg. Stars</th>
              <th align="left" >LC & HC Verified by Cloning</th>
              <th align="left" >See Entry</th>

            </tr>
          </thead>
        </table>
</div>


{% endblock %}